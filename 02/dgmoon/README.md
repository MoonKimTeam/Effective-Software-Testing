# Chapter 02 명세 기반 테스트

요구사항(기능 명세서)은 매우 중요

- 무엇을 수행해야 하는지, 하지 말아야 하는지 기술해줌
- 구현, 검증 대상 비즈니스 규칙의 `복잡성`을 알려줌

명세 기반 테스트 - 요구사항을 테스트의 입력 케이스로 사용

ex) 애자일의 유저 스토리, UML 유스케이스

체계적인 테스트가 필요할 때 명세 기반 테스트가 적합(그 이후에 구조 기반 테스트)

## 요구사항이 전부다 - subStringsBetween() 예제

명세 기반 테스트 단계

1. 요구사항과 입출력에 대해 이해하기
    - 목표(무엇을 수행하는가), 매개변수(입력) 확인
2. 여러 입력값에 대해 프로그램이 수행하는 바를 탐색하기
    - 메서드를 잘 이해하기
    - 테스트 케이스로 코드를 더 잘 이해할수 있게 된다면 테스트는 좋든 나쁘든 상관 없다
3. 테스트 가능한 입출력과 구획 탐색
    - 가능한 입출력은 무한대 but 프로그램은 일부 입력 집합에 대해 동일하게 작동함(하나의 케이스가 그 집합을 대표함)
    - 이러한 탐색을 체계적으로 하는 방법
        - 내가 전달하는 입력은 어떤 부류에 해당하는가
        - 각 입력과 다른 조합에 대해 어떤 조합을 만들 수 있는가
        - 이 프로그램에서 기대하는 여러부류의 출력(배열이나 빈 배열, 널 등)
        - 개별 입력부터 시작 -> 각각의 입력을 조합
        - 출력 케이스 종류
4. 경계 분석하기
    - 버그는 입력 도메인의 경계에서 흔히 발생
    - 경계를 발견할 때마다 입력을 한 경계에서 다른 경계로 이동시키며 테스트
    - 접점(on point) - 경계, 거점(off point) 접점이 속해 있지 않은 구획에 있으면서 경계에 대한 테스트
    - 내점(in point) - 조건이 참인 점, 외점(off point) - 조건이 거짓인 점
5. 테스트 케이스 고안하기
    - 나눈 구획들을 어떻게 조합할지는 실용적으로 고안해야 함 ex) 널 문자열 구획은 한번만 테스트
6. 테스트 케이스 자동화하기
    - 테스트는 자동화해야 의미가 있음
    - cf) 테스트 스위트: 테스트 케이스(테스트 메서드)들을 하나로 묶은 것
    - 테스트 케이스당 하나의 메서드르 보장할 수도 있음
    - parameterized Test 사용해도 좋음
7. 창의성과 경험을 발휘해서 테스트 스위트를 강화하기
    - 체계적인 테스트 후에도 흥미로운 변형(다른 형태의 테스트)를 생각해보자
    - 새로운 테스트가 떠오르면 테스트에 추가하자

명세 테스트 -> 범주-구획법(오스트랜드, 발서)과 도메인 테스트 워크북(카너)을 섞어서 만듦

## 명세테스트로 버그 찾기

- 체계적인 테스트를 통해서 코드의 버그를 찾을 수 있다.
- 도메인 지식은 좋은 테스트 케이스를 위해 중요하고 없더라도 요구사항을 잘 이해할 필요가 있다.

## 현업에서의 명세 테스트

- 프로세스는 연속적이 아니라 반복적이어야 함(단계 완료 후에 넘어가는게 아니라 단계를 이리 저리 왔다 갔다 함)
- 명세 테스트 빈도: 테스트를 몇 번 거쳐도 실패하지 않을 때 중단
- 경계가 배타적 구획인지 경계인지는 중요하지 않음: 중요한 건 테스트 케이스를 도출하고 버그가 스며들지않는 것
- 접점과 거점 충분, but 내점과 외점도 추가하자: 접점과 거점이 있는데 내점과 외점은 중복 but 무의미하진 않음
- 이해도를 높이기 위해 입력을 변경해 사용하자
- 조합의 수가 무수히 많다면 실용적이어야
    - 가능한 조합의 수를 줄이자(예외적인 동작만을 테스트하는 것도 한 방법)
    - 메서드 수준에서 많은 조합이 발생하면 메서드를 두 개로 나누자
- 무엇을 넣을지 모르면 일단 넣어보기
    - 가능하면 디버깅이 용이한 간단한 값 선택
- 관심없는 입력에 대해서는 합리적인 값을 선택
- 널과 예외 케이스는 의미가 있을 때만 사용
    - UI와 관련 있는 경우라면 널, 빈 문자열, 비일반적 정수값 등 코너 케이스를 많이 행하고 그렇지 않으면 생략
- 테스트가 동일한 스켈레톤을 갖는 경우 parameterized test
    - 너무 많은 중복은 문제가 된다.
- 요구사항은 세분화 가능
    - 대규모 테스트도 명세 테스트를 적용할 수 있음
- 클래스와 상태에 대해서 어떻게 동작하는지
    - 고려해야 하는 유일한 차이는 입력 인수뿐만 아니라 클래스의 상태도 고려하면 됨
- 경험과 창의성의 역할
    - 개발자들의 경험과 창의성의 차이에 따라 방식에 차이가 생길 수 있음 
